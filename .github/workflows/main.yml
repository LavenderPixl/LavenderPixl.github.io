name: Deploy to GitHub Pages

on:
  push:
    branches:
    - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:    
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Install dependencies
      run: npm install


    - name: Inject secrets into environment for build
      run: echo "VITE_GTOKEN=${{ secrets.VITE_GTOKEN }}" >> $GITHUB_ENV


    - name: Build the project
      run: npm run build  # Access MY_SECRET during the build if needed


    - name: Deploy to GitHub Pages
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Use only GITHUB_TOKEN for deployment authentication
      run: |
        git config --global user.email "annajacobsen1999@hotmail.com"
        git config --global user.name "LavenderPixl"
        npm install -g gh-pages
        gh-pages -d dist